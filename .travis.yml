language: node_js
branches:
  except:
    - prod

env:
  global:
    - PORT=3000
    - SERVER=localhost
    - USERNAME=SA
    - PASSWORD=SQLServer2019-password
    - DATABASE=sqlserver-database
    - MSSQL_SA_PASSWORD=SQLServer2019-password
    - SQL_ENABLE_AGENT=y
    - ACCEPT_EULA=y
    - TEST_USERID=0000000000000000

jobs:
  include:
  - name: "Node.js 10.x"
    node_js: 10
  - name: "Node.js 12.x"
    node_js: 12

before_script:
  - bash ./setup/ci.sh

after_script:
  - systemctl stop mssql-server

git:
  quiet: true
